# Snakemake 9.x Profile for SLURM execution
# IMPORTANT: Edit the account and partition values below to match your HPC

# Executor configuration
executor: slurm
jobs: 100
latency-wait: 60

# Conda settings
use-conda: true
conda-frontend: mamba

# Execution behavior
rerun-incomplete: true
keep-going: true
printshellcmds: true
quiet:
  - progress  # Suppress repetitive progress messages

# Default resources for all rules
default-resources:
  - runtime=180        # minutes
  - mem_mb=9000
  - threads=1
  - slurm_account=     # TODO: Set your allocation name (e.g., ratan-lab)
  - slurm_partition=   # TODO: Set your partition (e.g., standard)

# Rule-specific resource overrides
set-resources:

  check_quality:
    threads: 2
    mem_mb: 4000
    runtime: 60

  trim_adapters:
    threads: 4
    mem_mb: 8000
    runtime: 480

  align_reads_pe:
    threads: 8
    mem_mb: 30000
    runtime: 960

  align_reads_se:
    threads: 8
    mem_mb: 30000
    runtime: 960
 
  convert_to_binary:
    threads: 2
    mem_mb: 8000
    runtime: 120

  find_ecoli_reads:
    threads: 4
    mem_mb: 8000
    runtime: 480

  bam_to_bed:
    threads: 2
    mem_mb: 8000
    runtime: 180

  remove_duplicates:
    threads: 2
    mem_mb: 12000
    runtime: 240

  call_seacr_peaks:
    threads: 1
    mem_mb: 8000
    runtime: 120

  assess_peaks:
    threads: 2
    mem_mb: 12000
    runtime: 180

  dedup_assess_peaks:
    threads: 2
    mem_mb: 12000
    runtime: 180

  make_peak_heatmap:
    threads: 2
    mem_mb: 12000
    runtime: 180

  calculate_tss_enrichment:
    threads: 4
    mem_mb: 12000
    runtime: 180

  generate_html_report:
    threads: 1
    mem_mb: 8000
    runtime: 120

# SLURM executor plugin configuration
slurm:
  extra: "--parsable"
  status_command: sacct  # Force sacct instead of squeue for job status


